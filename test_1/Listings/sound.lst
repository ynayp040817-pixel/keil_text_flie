C51 COMPILER V9.60.7.0   SOUND                                                             02/13/2026 15:38:20 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE SOUND
OBJECT MODULE PLACED IN .\Objects\sound.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE sound.c OPTIMIZE(8,SPEED) BROWSE INCDIR(C:\Keil_v5\C51\INC\STC) DEBUG OB
                    -JECTEXTEND PRINT(.\Listings\sound.lst) TABS(2) OBJECT(.\Objects\sound.obj)

line level    source

   1          #include <STC89C5xRC.H>
   2          
   3          // 定义蜂鸣器引脚
   4          sbit BUZZER = P2^3;
   5          
   6          // 更精确的延时函数
   7          void delay_ms(unsigned int ms)
   8          {
   9   1          unsigned int i, j;
  10   1          for(i = 0; i < ms; i++)
  11   1              for(j = 0; j < 114; j++);
  12   1      }
  13          
  14          // 微秒级延时，更精确
  15          void delay_us(unsigned char us)
  16          {
  17   1          while(us--);
  18   1      }
  19          
  20          // 产生指定频率的方波（用于无源蜂鸣器）
  21          void beep_freq(unsigned int freq, unsigned int duration_ms)
  22          {
  23   1          unsigned int period_us = 1000000 / freq;  // 周期（微秒）
  24   1          unsigned int half_period = period_us / 2;
  25   1          unsigned int cycles = (duration_ms * 1000) / period_us;
  26   1          unsigned int i;  // 在函数开头声明变量
  27   1          
  28   1          // 限制最小周期以确保准确性
  29   1          if(half_period < 10) half_period = 10;  // 最小10微秒半周期
  30   1          
  31   1          for(i = 0; i < cycles; i++)
  32   1          {
  33   2              BUZZER = 1;  // 输出高电平
  34   2              delay_us((unsigned char)half_period);
  35   2              BUZZER = 0;  // 输出低电平
  36   2              delay_us((unsigned char)half_period);
  37   2          }
  38   1      }
  39          
  40          // 播放音符
  41          void play_note(unsigned int frequency, unsigned int duration)
  42          {
  43   1          beep_freq(frequency, duration);
  44   1          delay_ms(100);  // 音符间的间隔稍长一些
  45   1      }
  46          
  47          void main()
  48          {
  49   1          // 使用更明显的音阶差异
  50   1          unsigned int notes[] = {220, 247, 262, 294, 330, 349, 392};  // 低八度音阶
  51   1          unsigned char i;  // 在函数开头声明变量
  52   1      
  53   1          while(1)
  54   1          {
C51 COMPILER V9.60.7.0   SOUND                                                             02/13/2026 15:38:20 PAGE 2   

  55   2              // 依次播放七个音阶
  56   2              for(i = 0; i < 7; i++)
  57   2              {
  58   3                  // 播放当前音符
  59   3                  play_note(notes[i], 600);  // 每个音符持续600ms，更容易分辨
  60   3              }
  61   2      
  62   2              delay_ms(1500);  // 每轮结束后暂停1.5秒
  63   2          }
  64   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    211    ----
   CONSTANT SIZE    =     14    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      17
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
